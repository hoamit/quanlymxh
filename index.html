<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Qu·∫£n L√Ω T√†i Kho·∫£n MXH</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        min-height: 100vh;
        padding: 20px;
      }

      .container {
        max-width: 1200px;
        margin: 0 auto;
        background: white;
        border-radius: 20px;
        box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
        overflow: hidden;
      }

      .header {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        padding: 30px;
        text-align: center;
      }

      .header h1 {
        font-size: 2.5rem;
        margin-bottom: 10px;
        font-weight: 300;
      }

      .header p {
        font-size: 1.1rem;
        opacity: 0.9;
      }

      .form-section {
        padding: 40px;
        background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
        position: relative;
      }

      .form-section::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 4px;
        background: linear-gradient(90deg, #667eea, #764ba2, #f093fb, #f5576c);
        background-size: 400% 400%;
        animation: gradientShift 3s ease infinite;
      }

      @keyframes gradientShift {
        0% { background-position: 0% 50%; }
        50% { background-position: 100% 50%; }
        100% { background-position: 0% 50%; }
      }

      @keyframes slideIn {
        from { transform: translateX(100%); opacity: 0; }
        to { transform: translateX(0); opacity: 1; }
      }

      @keyframes slideOut {
        from { transform: translateX(0); opacity: 1; }
        to { transform: translateX(100%); opacity: 0; }
      }

      .form-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
        gap: 25px;
        margin-bottom: 35px;
        background: white;
        padding: 30px;
        border-radius: 15px;
        box-shadow: 0 5px 20px rgba(0, 0, 0, 0.08);
      }

      .form-group {
        display: flex;
        flex-direction: column;
        position: relative;
      }

      .form-group label {
        font-weight: 600;
        margin-bottom: 10px;
        color: #2c3e50;
        font-size: 0.95rem;
        display: flex;
        align-items: center;
        gap: 8px;
      }

      .form-group label::before {
        content: '';
        width: 4px;
        height: 16px;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        border-radius: 2px;
      }

      input, select {
        padding: 18px 20px;
        border: 2px solid #e8ecf0;
        border-radius: 12px;
        font-size: 1rem;
        transition: all 0.3s ease;
        background: #fafbfc;
        color: #2c3e50;
        font-weight: 500;
      }

      input:focus, select:focus {
        outline: none;
        border-color: #667eea;
        background: white;
        box-shadow: 0 0 0 4px rgba(102, 126, 234, 0.1);
        transform: translateY(-2px);
      }

      input::placeholder, select::placeholder {
        color: #a0aec0;
        font-weight: 400;
      }

      .form-group small {
        margin-top: 8px;
        color: #718096;
        font-size: 0.8rem;
        font-style: italic;
        display: flex;
        align-items: center;
        gap: 5px;
      }

      .form-group small::before {
        content: 'üí°';
        font-size: 0.9rem;
      }

      .btn {
        padding: 15px 30px;
        border: none;
        border-radius: 10px;
        font-size: 1rem;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
        text-transform: uppercase;
        letter-spacing: 0.5px;
      }

      .btn-primary {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        grid-column: 1 / -1;
        justify-self: center;
        min-width: 250px;
        padding: 18px 40px;
        font-size: 1.1rem;
        font-weight: 700;
        border-radius: 15px;
        position: relative;
        overflow: hidden;
      }

      .btn-primary::before {
        content: '';
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
        transition: left 0.5s;
      }

      .btn-primary:hover::before {
        left: 100%;
      }

      .btn-primary:hover {
        transform: translateY(-3px);
        box-shadow: 0 15px 30px rgba(102, 126, 234, 0.4);
      }

      .btn-primary:active {
        transform: translateY(-1px);
      }

      .btn-danger {
        background: linear-gradient(135deg, #ff6b6b 0%, #ee5a52 100%);
        color: white;
        padding: 8px 16px;
        font-size: 0.8rem;
        min-width: auto;
      }

      .btn-danger:hover {
        transform: translateY(-1px);
        box-shadow: 0 5px 15px rgba(255, 107, 107, 0.3);
      }

      .table-container {
        padding: 0 40px 40px;
        background: white;
      }

      table {
        width: 100%;
        border-collapse: collapse;
        border-radius: 10px;
        overflow: hidden;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
        display: table;
        table-layout: fixed;
      }

      th {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        padding: 20px;
        text-align: left;
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 0.5px;
        font-size: 0.9rem;
      }

      td {
        padding: 20px;
        border-bottom: 1px solid #e1e5e9;
        color: #333;
      }

      tr:hover {
        background-color: #f8f9fa;
      }

      .social-icon {
        width: 24px;
        height: 24px;
        margin-right: 10px;
        vertical-align: middle;
      }

      .actions {
        display: flex;
        gap: 10px;
        align-items: center;
      }

      .empty-state {
        text-align: center;
        padding: 60px 20px;
        color: #666;
      }

      .empty-state i {
        font-size: 4rem;
        margin-bottom: 20px;
        opacity: 0.3;
      }

      .tabs {
        display: flex;
        background: #f8f9fa;
        border-bottom: 1px solid #e1e5e9;
        overflow-x: auto;
      }

      .tab {
        padding: 15px 25px;
        cursor: pointer;
        border: none;
        background: none;
        font-size: 1rem;
        font-weight: 500;
        color: #666;
        transition: all 0.3s ease;
        white-space: nowrap;
        border-bottom: 3px solid transparent;
      }

      .tab:hover {
        background: #e9ecef;
        color: #333;
      }

      .tab.active {
        color: #667eea;
        border-bottom-color: #667eea;
        background: white;
      }

      .tab-content {
        display: none;
        padding: 0 40px 40px;
        background: white;
        min-height: 200px;
      }

      .tab-content.active {
        display: block;
      }

      .tab-stats {
        display: flex;
        gap: 20px;
        margin-bottom: 20px;
        flex-wrap: wrap;
      }

      .stat-card {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        padding: 20px;
        border-radius: 10px;
        text-align: center;
        min-width: 120px;
        flex: 1;
      }

      .stat-number {
        font-size: 2rem;
        font-weight: bold;
        margin-bottom: 5px;
      }

      .stat-label {
        font-size: 0.9rem;
        opacity: 0.9;
      }

      @media (max-width: 768px) {
        .form-grid {
          grid-template-columns: 1fr;
        }
        
        .header h1 {
          font-size: 2rem;
        }
        
        .form-section, .table-container {
          padding: 20px;
        }
        
        table {
          font-size: 0.9rem;
          display: table !important;
          width: 100% !important;
        }
        
        th, td {
          padding: 15px 10px;
          display: table-cell !important;
        }
        
        .tab-content {
          padding: 0 20px 20px !important;
        }
        
        .tab-stats {
          flex-direction: column;
          gap: 10px;
        }
        
        .stat-card {
          min-width: auto;
        }
      }
    </style>
  </head>
  <body>
    <div class="container">
      <div class="header">
        <h1>üì± Qu·∫£n L√Ω T√†i Kho·∫£n MXH</h1>
        <p>Qu·∫£n l√Ω t√†i kho·∫£n m·∫°ng x√£ h·ªôi m·ªôt c√°ch d·ªÖ d√†ng v√† b·∫£o m·∫≠t</p>
      </div>

    <div class="form-section">
        <div class="form-grid">
          <div class="form-group">
            <label for="socialType">Lo·∫°i MXH</label>
            <select id="socialType" required>
              <option value="">Ch·ªçn lo·∫°i m·∫°ng x√£ h·ªôi</option>
              <option value="facebook">üìò Facebook</option>
              <option value="instagram">üì∑ Instagram</option>
              <option value="tiktok">üéµ TikTok</option>
              <option value="youtube">üì∫ YouTube</option>
              <option value="twitter">üê¶ Twitter/X</option>
              <option value="linkedin">üíº LinkedIn</option>
              <option value="zalo">üí¨ Zalo</option>
              <option value="telegram">‚úàÔ∏è Telegram</option>
              <option value="discord">üéÆ Discord</option>
              <option value="other">üîó Kh√°c</option>
            </select>
          </div>
          
          <div class="form-group">
            <label for="name">T√™n hi·ªÉn th·ªã</label>
            <input type="text" id="name" placeholder="Nh·∫≠p t√™n hi·ªÉn th·ªã" required />
          </div>
          
          <div class="form-group">
            <label for="id">T√™n ƒëƒÉng nh·∫≠p/Email</label>
            <input type="text" id="id" placeholder="Nh·∫≠p t√™n ƒëƒÉng nh·∫≠p ho·∫∑c email" required />
          </div>
          
          <div class="form-group">
            <label for="accountId">ID T√†i kho·∫£n</label>
            <input type="text" id="accountId" placeholder="Nh·∫≠p ID t√†i kho·∫£n (user ID, profile ID)" />
            <small style="color: #666; font-size: 0.8rem; margin-top: 5px;">T√πy ch·ªçn - ID s·ªë ho·∫∑c username ƒë·∫∑c bi·ªát</small>
          </div>
          
          <div class="form-group">
            <label for="password">M·∫≠t kh·∫©u</label>
            <input type="password" id="password" placeholder="Nh·∫≠p m·∫≠t kh·∫©u" required />
          </div>
        </div>
        
        <div style="display: flex; gap: 15px; justify-content: center; flex-wrap: wrap;">
          <button class="btn btn-primary" onclick="addAccount()">
            ‚ûï Th√™m T√†i Kho·∫£n
          </button>
          <button class="btn" onclick="syncToCloud()" style="background: linear-gradient(135deg, #ff6b6b 0%, #ee5a52 100%); color: white;">
            ‚òÅÔ∏è ƒê·ªìng B·ªô Cloud
          </button>
          <button class="btn" onclick="loadFromCloud()" style="background: linear-gradient(135deg, #4ecdc4 0%, #44a08d 100%); color: white;">
            üì• T·∫£i T·ª´ Cloud
          </button>
          <button class="btn" onclick="viewDatabaseData()" style="background: linear-gradient(135deg, #9b59b6 0%, #8e44ad 100%); color: white;">
            üëÅÔ∏è Xem Database
          </button>
          <button class="btn" onclick="exportData()" style="background: linear-gradient(135deg, #28a745 0%, #20c997 100%); color: white;">
            üì§ Xu·∫•t D·ªØ Li·ªáu
          </button>
          <button class="btn" onclick="importData()" style="background: linear-gradient(135deg, #17a2b8 0%, #6f42c1 100%); color: white;">
            üì• Nh·∫≠p D·ªØ Li·ªáu
          </button>
          <input type="file" id="fileInput" accept=".json" style="display: none;" onchange="handleFileImport(event)">
        </div>
        
        <div style="text-align: center; margin-top: 20px; padding: 15px; background: rgba(102, 126, 234, 0.1); border-radius: 10px;">
          <div style="font-weight: 600; color: #667eea; margin-bottom: 10px;">üîê B·∫£o m·∫≠t d·ªØ li·ªáu</div>
          <div style="font-size: 0.9rem; color: #666; margin-bottom: 10px;">
            D·ªØ li·ªáu ƒë∆∞·ª£c m√£ h√≥a v√† l∆∞u tr·ªØ an to√†n tr√™n cloud<br>
            B·∫°n c√≥ th·ªÉ truy c·∫≠p t·ª´ b·∫•t k·ª≥ thi·∫øt b·ªã n√†o
          </div>
          <div style="font-size: 0.8rem; color: #999; background: rgba(255,255,255,0.5); padding: 8px; border-radius: 5px;">
            üí° <strong>Setup:</strong> V√†o jsonbin.io ‚Üí L·∫•y API Key ‚Üí Thay v√†o code
          </div>
        </div>
      </div>

      <div class="tabs">
        <button class="tab active" onclick="switchTab('all')">
          üì± T·∫•t c·∫£ (<span id="count-all">0</span>)
        </button>
        <button class="tab" onclick="switchTab('facebook')">
          üìò Facebook (<span id="count-facebook">0</span>)
        </button>
        <button class="tab" onclick="switchTab('instagram')">
          üì∑ Instagram (<span id="count-instagram">0</span>)
        </button>
        <button class="tab" onclick="switchTab('tiktok')">
          üéµ TikTok (<span id="count-tiktok">0</span>)
        </button>
        <button class="tab" onclick="switchTab('youtube')">
          üì∫ YouTube (<span id="count-youtube">0</span>)
        </button>
        <button class="tab" onclick="switchTab('twitter')">
          üê¶ Twitter/X (<span id="count-twitter">0</span>)
        </button>
        <button class="tab" onclick="switchTab('other')">
          üîó Kh√°c (<span id="count-other">0</span>)
        </button>
      </div>

      <div class="tab-content active" id="tab-all">
        <div class="tab-stats">
          <div class="stat-card">
            <div class="stat-number" id="total-accounts">0</div>
            <div class="stat-label">T·ªïng t√†i kho·∫£n</div>
          </div>
          <div class="stat-card">
            <div class="stat-number" id="total-platforms">0</div>
            <div class="stat-label">N·ªÅn t·∫£ng</div>
          </div>
    </div>

    <table id="accountTable">
      <thead>
        <tr>
          <th>STT</th>
              <th>Lo·∫°i MXH</th>
              <th>T√™n hi·ªÉn th·ªã</th>
              <th>T√™n ƒëƒÉng nh·∫≠p</th>
              <th>ID T√†i kho·∫£n</th>
          <th>M·∫≠t kh·∫©u</th>
              <th>Thao t√°c</th>
        </tr>
      </thead>
          <tbody id="accountTableBody">
        <!-- D·ªØ li·ªáu t√†i kho·∫£n s·∫Ω hi·ªán ·ªü ƒë√¢y -->
      </tbody>
    </table>
        
        <div id="emptyState" class="empty-state" style="display: none;">
          <div>üì±</div>
          <h3>Ch∆∞a c√≥ t√†i kho·∫£n n√†o</h3>
          <p>H√£y th√™m t√†i kho·∫£n ƒë·∫ßu ti√™n c·ªßa b·∫°n!</p>
        </div>
      </div>

      <div class="tab-content" id="tab-facebook">
        <div class="tab-stats">
          <div class="stat-card">
            <div class="stat-number" id="facebook-count">0</div>
            <div class="stat-label">T√†i kho·∫£n Facebook</div>
          </div>
        </div>
        
        <table id="facebookTable">
          <thead>
            <tr>
              <th>STT</th>
              <th>T√™n hi·ªÉn th·ªã</th>
              <th>T√™n ƒëƒÉng nh·∫≠p</th>
              <th>ID T√†i kho·∫£n</th>
              <th>M·∫≠t kh·∫©u</th>
              <th>Thao t√°c</th>
            </tr>
          </thead>
          <tbody id="facebookTableBody">
            <!-- D·ªØ li·ªáu Facebook s·∫Ω hi·ªán ·ªü ƒë√¢y -->
          </tbody>
        </table>
        
        <div id="facebookEmptyState" class="empty-state" style="display: none;">
          <div>üìò</div>
          <h3>Ch∆∞a c√≥ t√†i kho·∫£n Facebook</h3>
          <p>H√£y th√™m t√†i kho·∫£n Facebook ƒë·∫ßu ti√™n!</p>
        </div>
      </div>

      <div class="tab-content" id="tab-instagram">
        <div class="tab-stats">
          <div class="stat-card">
            <div class="stat-number" id="instagram-count">0</div>
            <div class="stat-label">T√†i kho·∫£n Instagram</div>
          </div>
        </div>
        
        <table id="instagramTable">
          <thead>
            <tr>
              <th>STT</th>
              <th>T√™n hi·ªÉn th·ªã</th>
              <th>T√™n ƒëƒÉng nh·∫≠p</th>
              <th>ID T√†i kho·∫£n</th>
              <th>M·∫≠t kh·∫©u</th>
              <th>Thao t√°c</th>
            </tr>
          </thead>
          <tbody id="instagramTableBody">
            <!-- D·ªØ li·ªáu Instagram s·∫Ω hi·ªán ·ªü ƒë√¢y -->
          </tbody>
        </table>
        
        <div id="instagramEmptyState" class="empty-state" style="display: none;">
          <div>üì∑</div>
          <h3>Ch∆∞a c√≥ t√†i kho·∫£n Instagram</h3>
          <p>H√£y th√™m t√†i kho·∫£n Instagram ƒë·∫ßu ti√™n!</p>
        </div>
      </div>

      <div class="tab-content" id="tab-tiktok">
        <div class="tab-stats">
          <div class="stat-card">
            <div class="stat-number" id="tiktok-count">0</div>
            <div class="stat-label">T√†i kho·∫£n TikTok</div>
          </div>
        </div>
        
        <table id="tiktokTable">
          <thead>
            <tr>
              <th>STT</th>
              <th>T√™n hi·ªÉn th·ªã</th>
              <th>T√™n ƒëƒÉng nh·∫≠p</th>
              <th>ID T√†i kho·∫£n</th>
              <th>M·∫≠t kh·∫©u</th>
              <th>Thao t√°c</th>
            </tr>
          </thead>
          <tbody id="tiktokTableBody">
            <!-- D·ªØ li·ªáu TikTok s·∫Ω hi·ªán ·ªü ƒë√¢y -->
          </tbody>
        </table>
        
        <div id="tiktokEmptyState" class="empty-state" style="display: none;">
          <div>üéµ</div>
          <h3>Ch∆∞a c√≥ t√†i kho·∫£n TikTok</h3>
          <p>H√£y th√™m t√†i kho·∫£n TikTok ƒë·∫ßu ti√™n!</p>
        </div>
      </div>

      <div class="tab-content" id="tab-youtube">
        <div class="tab-stats">
          <div class="stat-card">
            <div class="stat-number" id="youtube-count">0</div>
            <div class="stat-label">T√†i kho·∫£n YouTube</div>
          </div>
        </div>
        
        <table id="youtubeTable">
          <thead>
            <tr>
              <th>STT</th>
              <th>T√™n hi·ªÉn th·ªã</th>
              <th>T√™n ƒëƒÉng nh·∫≠p</th>
              <th>ID T√†i kho·∫£n</th>
              <th>M·∫≠t kh·∫©u</th>
              <th>Thao t√°c</th>
            </tr>
          </thead>
          <tbody id="youtubeTableBody">
            <!-- D·ªØ li·ªáu YouTube s·∫Ω hi·ªán ·ªü ƒë√¢y -->
          </tbody>
        </table>
        
        <div id="youtubeEmptyState" class="empty-state" style="display: none;">
          <div>üì∫</div>
          <h3>Ch∆∞a c√≥ t√†i kho·∫£n YouTube</h3>
          <p>H√£y th√™m t√†i kho·∫£n YouTube ƒë·∫ßu ti√™n!</p>
        </div>
      </div>

      <div class="tab-content" id="tab-twitter">
        <div class="tab-stats">
          <div class="stat-card">
            <div class="stat-number" id="twitter-count">0</div>
            <div class="stat-label">T√†i kho·∫£n Twitter/X</div>
          </div>
        </div>
        
        <table id="twitterTable">
          <thead>
            <tr>
              <th>STT</th>
              <th>T√™n hi·ªÉn th·ªã</th>
              <th>T√™n ƒëƒÉng nh·∫≠p</th>
              <th>ID T√†i kho·∫£n</th>
              <th>M·∫≠t kh·∫©u</th>
              <th>Thao t√°c</th>
            </tr>
          </thead>
          <tbody id="twitterTableBody">
            <!-- D·ªØ li·ªáu Twitter s·∫Ω hi·ªán ·ªü ƒë√¢y -->
          </tbody>
        </table>
        
        <div id="twitterEmptyState" class="empty-state" style="display: none;">
          <div>üê¶</div>
          <h3>Ch∆∞a c√≥ t√†i kho·∫£n Twitter/X</h3>
          <p>H√£y th√™m t√†i kho·∫£n Twitter/X ƒë·∫ßu ti√™n!</p>
        </div>
      </div>

      <div class="tab-content" id="tab-other">
        <div class="tab-stats">
          <div class="stat-card">
            <div class="stat-number" id="other-count">0</div>
            <div class="stat-label">T√†i kho·∫£n kh√°c</div>
          </div>
        </div>
        
        <table id="otherTable">
          <thead>
            <tr>
              <th>STT</th>
              <th>Lo·∫°i MXH</th>
              <th>T√™n hi·ªÉn th·ªã</th>
              <th>T√™n ƒëƒÉng nh·∫≠p</th>
              <th>ID T√†i kho·∫£n</th>
              <th>M·∫≠t kh·∫©u</th>
              <th>Thao t√°c</th>
            </tr>
          </thead>
          <tbody id="otherTableBody">
            <!-- D·ªØ li·ªáu kh√°c s·∫Ω hi·ªán ·ªü ƒë√¢y -->
          </tbody>
        </table>
        
        <div id="otherEmptyState" class="empty-state" style="display: none;">
          <div>üîó</div>
          <h3>Ch∆∞a c√≥ t√†i kho·∫£n kh√°c</h3>
          <p>H√£y th√™m t√†i kho·∫£n kh√°c ƒë·∫ßu ti√™n!</p>
        </div>
      </div>
    </div>

    <script>
      let accounts = [];
      let userId = localStorage.getItem('userId') || generateUserId();
      
      // Supabase Database (mi·ªÖn ph√≠, ·ªïn ƒë·ªãnh)
      const SUPABASE_URL = 'https://tqtmovrgjchbwqmdgbdb.supabase.co';
      const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InRxdG1vdnJnamNoYndxbWRnYmRiIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTkxNTQ5MzYsImV4cCI6MjA3NDczMDkzNn0.5kXzCyvbYXsYdXAkjaixiru9lZHRPj6AXW9y8UJg5Zs';
      
      // Database mode: 'local', 'supabase'
      const DATABASE_MODE = 'supabase';

      function generateUserId() {
        // S·ª≠ d·ª•ng User ID c·ªë ƒë·ªãnh ƒë·ªÉ t·∫•t c·∫£ thi·∫øt b·ªã d√πng chung
        const id = 'shared_user_hoamit';
        localStorage.setItem('userId', id);
        return id;
      }

      function encryptData(data) {
        // Simple encryption (trong th·ª±c t·∫ø n√™n d√πng crypto m·∫°nh h∆°n)
        return btoa(JSON.stringify(data));
      }

      function decryptData(encryptedData) {
        try {
          return JSON.parse(atob(encryptedData));
        } catch (e) {
          return null;
        }
      }

      // Load accounts from localStorage on page load
      window.onload = function() {
        // Load from localStorage first (immediate display)
        const savedAccounts = localStorage.getItem('socialAccounts');
        if (savedAccounts) {
          accounts = JSON.parse(savedAccounts);
          renderAccounts();
        }
        
        // Then try to load from cloud (background)
        setTimeout(() => {
          loadFromCloud();
        }, 1000);
        
        // Auto sync every 10 minutes
        setInterval(syncToCloud, 10 * 60 * 1000);
      };

      async function syncToCloud() {
        if (accounts.length === 0) {
          showNotification('‚ö†Ô∏è Kh√¥ng c√≥ d·ªØ li·ªáu ƒë·ªÉ ƒë·ªìng b·ªô!', 'info');
          return;
        }

        try {
          showNotification('üîÑ ƒêang ƒë·ªìng b·ªô l√™n database...', 'info');
          
          const data = {
            userId: userId,
            accounts: accounts,
            lastSync: new Date().toISOString(),
            version: '1.0'
          };

          if (DATABASE_MODE === 'supabase') {
            await syncToSupabase(data);
          } else {
            await syncToLocalBackup(data);
          }
          
        } catch (error) {
          console.error('Sync error:', error);
          showNotification('‚ùå L·ªói ƒë·ªìng b·ªô! S·ª≠ d·ª•ng backup local.', 'error');
        }
      }

      async function syncToSupabase(data) {
        // Supabase API call
        const response = await fetch(`${SUPABASE_URL}/rest/v1/user_data`, {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
            'apikey': SUPABASE_ANON_KEY,
            'Authorization': `Bearer ${SUPABASE_ANON_KEY}`
          },
          body: JSON.stringify({
            user_id: userId,
            data: JSON.stringify(data),
            updated_at: new Date().toISOString()
          })
        });

        if (response.ok) {
          localStorage.setItem('lastCloudSync', new Date().getTime().toString());
          showNotification('‚úÖ ƒê√£ ƒë·ªìng b·ªô l√™n Supabase th√†nh c√¥ng!', 'success');
        } else {
          throw new Error('Supabase sync failed');
        }
      }

      async function syncToLocalBackup(data) {
        // Fallback: Export to JSON file
        const dataStr = JSON.stringify(data, null, 2);
        const dataBlob = new Blob([dataStr], {type: 'application/json'});
        
        const link = document.createElement('a');
        link.href = URL.createObjectURL(dataBlob);
        link.download = `backup-${new Date().toISOString().split('T')[0]}.json`;
        link.click();
        
        localStorage.setItem('lastCloudSync', new Date().getTime().toString());
        showNotification('‚úÖ ƒê√£ t·∫°o backup file th√†nh c√¥ng!', 'success');
      }

      async function loadFromCloud() {
        try {
          showNotification('üîÑ ƒêang t·∫£i d·ªØ li·ªáu t·ª´ database...', 'info');
          
          if (DATABASE_MODE === 'supabase') {
            await loadFromSupabase();
          } else {
            showNotification('‚ö†Ô∏è Ch·∫ø ƒë·ªô local - kh√¥ng c√≥ cloud data.', 'info');
          }
        } catch (error) {
          console.error('Load error:', error);
          showNotification('‚ö†Ô∏è Kh√¥ng th·ªÉ t·∫£i t·ª´ database. S·ª≠ d·ª•ng d·ªØ li·ªáu local.', 'info');
        }
      }

      async function loadFromSupabase() {
        const response = await fetch(`${SUPABASE_URL}/rest/v1/user_data?user_id=eq.${userId}`, {
          headers: {
            'apikey': SUPABASE_ANON_KEY,
            'Authorization': `Bearer ${SUPABASE_ANON_KEY}`
          }
        });

        if (response.ok) {
          const data = await response.json();
          
          if (data.length > 0) {
            const userData = JSON.parse(data[0].data);
            const cloudAccounts = userData.accounts;
            
            // So s√°nh v·ªõi d·ªØ li·ªáu local
            const localAccounts = JSON.parse(localStorage.getItem('socialAccounts') || '[]');
            
            if (cloudAccounts.length > localAccounts.length) {
              // Cloud c√≥ nhi·ªÅu d·ªØ li·ªáu h∆°n -> c·∫≠p nh·∫≠t
              accounts = cloudAccounts;
              saveAccounts();
              renderAccounts();
              showNotification(`‚úÖ ƒê√£ c·∫≠p nh·∫≠t ${accounts.length} t√†i kho·∫£n t·ª´ database!`, 'success');
            } else if (cloudAccounts.length === localAccounts.length) {
              // D·ªØ li·ªáu gi·ªëng nhau -> kh√¥ng c·∫ßn c·∫≠p nh·∫≠t
              showNotification('üì± D·ªØ li·ªáu ƒë√£ ƒë·ªìng b·ªô', 'info');
            } else {
              // Local c√≥ nhi·ªÅu h∆°n -> kh√¥ng c·∫≠p nh·∫≠t
              showNotification('üì± D·ªØ li·ªáu local m·ªõi nh·∫•t', 'info');
            }
          } else {
            showNotification('üì≠ Ch∆∞a c√≥ d·ªØ li·ªáu trong database', 'info');
          }
        } else {
          showNotification('‚ö†Ô∏è Kh√¥ng th·ªÉ k·∫øt n·ªëi database', 'info');
        }
      }

      function showNotification(message, type = 'info') {
        const notification = document.createElement('div');
        const colors = {
          success: 'linear-gradient(135deg, #28a745, #20c997)',
          error: 'linear-gradient(135deg, #dc3545, #c82333)',
          info: 'linear-gradient(135deg, #17a2b8, #6f42c1)'
        };
        
        notification.style.cssText = `
          position: fixed;
          top: 20px;
          right: 20px;
          background: ${colors[type] || colors.info};
          color: white;
          padding: 15px 20px;
          border-radius: 10px;
          box-shadow: 0 5px 15px rgba(0,0,0,0.2);
          z-index: 10000;
          font-weight: 600;
          animation: slideIn 0.3s ease;
          max-width: 300px;
        `;
        
        notification.textContent = message;
        document.body.appendChild(notification);
        
        setTimeout(() => {
          notification.style.animation = 'slideOut 0.3s ease';
          setTimeout(() => notification.remove(), 300);
        }, 3000);
      }

      function addAccount() {
        const socialType = document.getElementById("socialType").value;
        const name = document.getElementById("name").value;
        const id = document.getElementById("id").value;
        const accountId = document.getElementById("accountId").value;
        const password = document.getElementById("password").value;

        if (!socialType || !name || !id || !password) {
          alert("Vui l√≤ng nh·∫≠p ƒë·∫ßy ƒë·ªß th√¥ng tin!");
          return;
        }

        const account = { 
          socialType, 
          name, 
          id, 
          accountId: accountId || '', // ID t√†i kho·∫£n (t√πy ch·ªçn)
          password,
          uniqueId: Date.now() // Unique ID for deletion
        };
        
        accounts.push(account);
        saveAccounts();
        renderAccounts();

        // Clear input
        document.getElementById("socialType").value = "";
        document.getElementById("name").value = "";
        document.getElementById("id").value = "";
        document.getElementById("accountId").value = "";
        document.getElementById("password").value = "";
      }

      function deleteAccount(accountId) {
        if (confirm("B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën x√≥a t√†i kho·∫£n n√†y?")) {
          accounts = accounts.filter(acc => acc.uniqueId !== accountId);
          saveAccounts();
          renderAccounts();
        }
      }


      function saveAccounts() {
        localStorage.setItem('socialAccounts', JSON.stringify(accounts));
      }

      function getSocialIcon(socialType) {
        const icons = {
          'facebook': 'üìò',
          'instagram': 'üì∑',
          'tiktok': 'üéµ',
          'youtube': 'üì∫',
          'twitter': 'üê¶',
          'linkedin': 'üíº',
          'zalo': 'üí¨',
          'telegram': '‚úàÔ∏è',
          'discord': 'üéÆ',
          'other': 'üîó'
        };
        return icons[socialType] || 'üîó';
      }

      function getSocialName(socialType) {
        const names = {
          'facebook': 'Facebook',
          'instagram': 'Instagram',
          'tiktok': 'TikTok',
          'youtube': 'YouTube',
          'twitter': 'Twitter/X',
          'linkedin': 'LinkedIn',
          'zalo': 'Zalo',
          'telegram': 'Telegram',
          'discord': 'Discord',
          'other': 'Kh√°c'
        };
        return names[socialType] || 'Kh√°c';
      }

      let currentTab = 'all';

      function switchTab(tabName) {
        // Remove active class from all tabs and tab contents
        document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
        document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
        
        // Add active class to selected tab and content
        document.querySelector(`[onclick="switchTab('${tabName}')"]`).classList.add('active');
        document.getElementById(`tab-${tabName}`).classList.add('active');
        
        currentTab = tabName;
        renderAccounts();
      }

      function renderAccounts() {
        updateTabCounts();
        
        // Render all accounts tab
        renderTabContent('all', accounts, 'accountTableBody', 'emptyState');
        
        // Render individual platform tabs
        const platforms = ['facebook', 'instagram', 'tiktok', 'youtube', 'twitter'];
        platforms.forEach(platform => {
          const platformAccounts = accounts.filter(acc => acc.socialType === platform);
          renderTabContent(platform, platformAccounts, `${platform}TableBody`, `${platform}EmptyState`);
        });
        
        // Render other tab
        const otherAccounts = accounts.filter(acc => !['facebook', 'instagram', 'tiktok', 'youtube', 'twitter'].includes(acc.socialType));
        renderTabContent('other', otherAccounts, 'otherTableBody', 'otherEmptyState');
      }

      function renderTabContent(tabName, accountsList, tbodyId, emptyStateId) {
        const tbody = document.getElementById(tbodyId);
        const emptyState = document.getElementById(emptyStateId);
        
        if (accountsList.length === 0) {
          tbody.innerHTML = "";
          emptyState.style.display = "block";
          return;
        }

        emptyState.style.display = "none";
        tbody.innerHTML = "";

        accountsList.forEach((acc, index) => {
          const row = document.createElement("tr");
          
          if (tabName === 'all') {
            row.innerHTML = `
              <td>${index + 1}</td>
              <td>
                <span class="social-icon">${getSocialIcon(acc.socialType)}</span>
                ${getSocialName(acc.socialType)}
              </td>
              <td>${acc.name}</td>
              <td>${acc.id}</td>
              <td>${acc.accountId || '-'}</td>
              <td>${acc.password}</td>
              <td>
                <div class="actions">
                  <button class="btn btn-danger" onclick="deleteAccount(${acc.uniqueId})">
                    üóëÔ∏è X√≥a
                  </button>
                </div>
              </td>
            `;
          } else if (tabName === 'other') {
            row.innerHTML = `
              <td>${index + 1}</td>
              <td>
                <span class="social-icon">${getSocialIcon(acc.socialType)}</span>
                ${getSocialName(acc.socialType)}
              </td>
              <td>${acc.name}</td>
              <td>${acc.id}</td>
              <td>${acc.accountId || '-'}</td>
              <td>${acc.password}</td>
              <td>
                <div class="actions">
                  <button class="btn btn-danger" onclick="deleteAccount(${acc.uniqueId})">
                    üóëÔ∏è X√≥a
                  </button>
                </div>
              </td>
            `;
          } else {
            row.innerHTML = `
                      <td>${index + 1}</td>
                      <td>${acc.name}</td>
                      <td>${acc.id}</td>
              <td>${acc.accountId || '-'}</td>
                      <td>${acc.password}</td>
              <td>
                <div class="actions">
                  <button class="btn btn-danger" onclick="deleteAccount(${acc.uniqueId})">
                    üóëÔ∏è X√≥a
                  </button>
                </div>
              </td>
            `;
          }
          
          tbody.appendChild(row);
        });
      }

      function updateTabCounts() {
        // Update tab counts
        document.getElementById('count-all').textContent = accounts.length;
        document.getElementById('count-facebook').textContent = accounts.filter(acc => acc.socialType === 'facebook').length;
        document.getElementById('count-instagram').textContent = accounts.filter(acc => acc.socialType === 'instagram').length;
        document.getElementById('count-tiktok').textContent = accounts.filter(acc => acc.socialType === 'tiktok').length;
        document.getElementById('count-youtube').textContent = accounts.filter(acc => acc.socialType === 'youtube').length;
        document.getElementById('count-twitter').textContent = accounts.filter(acc => acc.socialType === 'twitter').length;
        document.getElementById('count-other').textContent = accounts.filter(acc => !['facebook', 'instagram', 'tiktok', 'youtube', 'twitter'].includes(acc.socialType)).length;
        
        // Update stats
        document.getElementById('total-accounts').textContent = accounts.length;
        const uniquePlatforms = new Set(accounts.map(acc => acc.socialType)).size;
        document.getElementById('total-platforms').textContent = uniquePlatforms;
        
        // Update individual platform counts
        document.getElementById('facebook-count').textContent = accounts.filter(acc => acc.socialType === 'facebook').length;
        document.getElementById('instagram-count').textContent = accounts.filter(acc => acc.socialType === 'instagram').length;
        document.getElementById('tiktok-count').textContent = accounts.filter(acc => acc.socialType === 'tiktok').length;
        document.getElementById('youtube-count').textContent = accounts.filter(acc => acc.socialType === 'youtube').length;
        document.getElementById('twitter-count').textContent = accounts.filter(acc => acc.socialType === 'twitter').length;
        document.getElementById('other-count').textContent = accounts.filter(acc => !['facebook', 'instagram', 'tiktok', 'youtube', 'twitter'].includes(acc.socialType)).length;
      }

      function exportData() {
        if (accounts.length === 0) {
          alert('Kh√¥ng c√≥ d·ªØ li·ªáu ƒë·ªÉ xu·∫•t!');
          return;
        }

        const data = {
          accounts: accounts,
          exportDate: new Date().toISOString(),
          version: '1.0'
        };

        const dataStr = JSON.stringify(data, null, 2);
        const dataBlob = new Blob([dataStr], {type: 'application/json'});
        
        const link = document.createElement('a');
        link.href = URL.createObjectURL(dataBlob);
        link.download = `social-accounts-backup-${new Date().toISOString().split('T')[0]}.json`;
        link.click();
        
        alert(`‚úÖ ƒê√£ xu·∫•t ${accounts.length} t√†i kho·∫£n th√†nh c√¥ng!`);
      }

      function importData() {
        document.getElementById('fileInput').click();
      }

      function handleFileImport(event) {
        const file = event.target.files[0];
        if (!file) return;

        const reader = new FileReader();
        reader.onload = function(e) {
          try {
            const data = JSON.parse(e.target.result);
            
            if (!data.accounts || !Array.isArray(data.accounts)) {
              throw new Error('File kh√¥ng h·ª£p l·ªá!');
            }

            if (confirm(`B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën nh·∫≠p ${data.accounts.length} t√†i kho·∫£n?\n\n‚ö†Ô∏è D·ªØ li·ªáu hi·ªán t·∫°i s·∫Ω b·ªã thay th·∫ø!`)) {
              accounts = data.accounts;
              saveAccounts();
              renderAccounts();
              alert(`‚úÖ ƒê√£ nh·∫≠p ${data.accounts.length} t√†i kho·∫£n th√†nh c√¥ng!`);
            }
          } catch (error) {
            alert('‚ùå L·ªói: File kh√¥ng h·ª£p l·ªá ho·∫∑c b·ªã h·ªèng!');
            console.error('Import error:', error);
          }
        };
        
        reader.readAsText(file);
        event.target.value = ''; // Reset file input
      }

      async function viewDatabaseData() {
        try {
          showNotification('üîÑ ƒêang t·∫£i d·ªØ li·ªáu t·ª´ database...', 'info');
          
          const response = await fetch(`${SUPABASE_URL}/rest/v1/user_data?select=*`, {
            headers: {
              'apikey': SUPABASE_ANON_KEY,
              'Authorization': `Bearer ${SUPABASE_ANON_KEY}`
            }
          });

          if (response.ok) {
            const data = await response.json();
            
            if (data.length === 0) {
              showNotification('üì≠ Database tr·ªëng! Ch∆∞a c√≥ d·ªØ li·ªáu n√†o.', 'info');
              return;
            }

            // Hi·ªÉn th·ªã d·ªØ li·ªáu trong popup
            let html = '<div style="padding: 20px; max-height: 400px; overflow-y: auto;">';
            html += '<h3>üìä D·ªØ li·ªáu trong Database:</h3>';
            
            data.forEach((row, index) => {
              const userData = JSON.parse(row.data);
              html += `<div style="margin: 15px 0; padding: 15px; border: 1px solid #ddd; border-radius: 8px;">`;
              html += `<strong>User ID:</strong> ${row.user_id}<br>`;
              html += `<strong>S·ªë t√†i kho·∫£n:</strong> ${userData.accounts.length}<br>`;
              html += `<strong>C·∫≠p nh·∫≠t:</strong> ${new Date(row.updated_at).toLocaleString()}<br>`;
              html += `<strong>D·ªØ li·ªáu:</strong><br>`;
              html += `<pre style="background: #f5f5f5; padding: 10px; border-radius: 4px; font-size: 12px;">${JSON.stringify(userData, null, 2)}</pre>`;
              html += `</div>`;
            });
            
            html += '</div>';
            
            // T·∫°o popup
            const popup = document.createElement('div');
            popup.style.cssText = `
              position: fixed;
              top: 0;
              left: 0;
              width: 100%;
              height: 100%;
              background: rgba(0,0,0,0.8);
              z-index: 10000;
              display: flex;
              align-items: center;
              justify-content: center;
            `;
            
            const content = document.createElement('div');
            content.style.cssText = `
              background: white;
              border-radius: 10px;
              max-width: 80%;
              max-height: 80%;
              overflow: hidden;
              box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            `;
            
            content.innerHTML = `
              <div style="padding: 20px; border-bottom: 1px solid #eee; display: flex; justify-content: space-between; align-items: center;">
                <h2 style="margin: 0;">üëÅÔ∏è D·ªØ li·ªáu Database</h2>
                <button onclick="this.closest('.popup').remove()" style="background: #ff6b6b; color: white; border: none; padding: 8px 16px; border-radius: 5px; cursor: pointer;">‚úï ƒê√≥ng</button>
              </div>
              ${html}
            `;
            
            popup.className = 'popup';
            popup.appendChild(content);
            document.body.appendChild(popup);
            
            showNotification(`‚úÖ ƒê√£ t·∫£i ${data.length} records t·ª´ database!`, 'success');
          } else {
            throw new Error('Load failed');
          }
        } catch (error) {
          console.error('View database error:', error);
          showNotification('‚ùå L·ªói t·∫£i d·ªØ li·ªáu t·ª´ database!', 'error');
        }
      }
    </script>
  </body>
</html>
